services:
  fabric-rest-api:
    image: kayvan/fabric:latest
    command: fabric-ai --serve --address 0.0.0.0:8080
    ports:
      # include permission for API requests from the host machine, such as with curl
      - "8080:8080"
    volumes:
      - ./fabric-config:/root/.config/fabric
    networks:
      - mcp-network

  fabric-mcp-server:
    build: ./fabric-mcp-repo/docker
    ports:
      - "8000:8000"  # Expose to host so client can reach it
    environment:
      - FABRIC_BASE_URL=http://fabric-rest-api:8080
      # - REST_API_URL=http://fabric-rest-api:8080
    depends_on:
      - fabric-rest-api
    networks:
      - mcp-network

networks:
  mcp-network:
    driver: bridge
